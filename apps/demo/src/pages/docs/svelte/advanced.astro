---
import Layout from "../../../layouts/Layout.astro";
---

<Layout title="Advanced Usage - Svelte">
  <div class="mb-4 text-sm font-mono text-neutral-500 uppercase tracking-widest">
    @elekcsv/svelte
  </div>

  <h1 class="mb-8 border-b-2 border-black pb-4">3.3 Advanced Usage</h1>

  <p class="text-xl text-neutral-600 leading-relaxed mb-10">
    The importer exposes a step-based state machine: <code>idle</code>,
    <code>parsing</code>, <code>mapping</code>, <code>validating</code>,
    <code>review</code>, and <code>complete</code>. You can use it to render
    wizard-like CSV import flows.
  </p>

  <h2>Reacting to Step Transitions</h2>
  <p>
    Use <code>onStepChange</code> for analytics, UI transitions, and navigation.
    It runs whenever the internal state machine moves to a new stage.
  </p>

  <pre><code>const importer = createCSVImporter(&#123;
  schema,
  onStepChange: (step) =&gt; &#123;
    if (step === 'mapping') &#123;
      analytics.track('csv_mapping_opened')
    &#125;

    if (step === 'complete') &#123;
      toast.success('Import completed')
    &#125;
  &#125;,
  onError: (message) =&gt; &#123;
    toast.error(message)
  &#125;,
&#125;)</code></pre>

  <h2>Manual Mapping Control</h2>
  <p>
    If you disable automatic mapping, you can drive column mapping with your own
    UI and commit when users confirm.
  </p>

  <pre><code>const importer = createCSVImporter(&#123;
  schema,
  autoMap: false,
&#125;)

// assign CSV column 0 to schema field "email"
importer.updateMapping(0, 'email')

// assign CSV column 1 to schema field "first_name"
importer.updateMapping(1, 'first_name')

// run validation on mapped data
importer.confirmMapping()</code></pre>

  <div class="mt-16 flex justify-between">
    <a
      href="/docs/svelte/basic"
      class="inline-flex items-center gap-2 px-6 py-3 border border-neutral-300 text-black hover:border-black rounded-md text-sm font-medium no-underline! transition-colors"
      style="text-decoration:none;"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Previous
    </a>
    <a
      href="/docs/svelte/full"
      class="inline-flex items-center gap-2 px-6 py-3 bg-black text-white hover:bg-neutral-800 rounded-md text-sm font-medium no-underline! transition-colors"
      style="text-decoration:none;"
    >
      Next: Full API
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
      </svg>
    </a>
  </div>
</Layout>
