---
// src/pages/docs/angular/advanced.astro
import Layout from "../../../layouts/Layout.astro";
---

<Layout title="Advanced Usage - Angular">
  <div class="mb-4 text-sm font-mono text-neutral-500 uppercase tracking-widest">
    @elekcsv/angular
  </div>

  <h1 class="mb-8 border-b-2 border-black pb-4">7.3 Advanced Usage</h1>

  <p class="text-xl text-neutral-600 leading-relaxed mb-10">
    The true power of <code>CSVImporterService</code> lies in its reactive state
    machine. Instead of manually toggling flags, you react to signal values from the
    importer lifecycle.
  </p>

  <h2>The Lifecycle State</h2>
  <p>
    The service exposes signal accessors tracking each stage of the user's import
    journey and helper methods for mapping and validation review.
  </p>

  <pre><code>// Component class
if (this.importer.isLoading()) &#123;
  return
&#125;

if (this.importer.currentState.step === 'review' && this.importer.hasErrors()) &#123;
  const errors = this.importer.getErrors(&#123; limit: 20 &#125;)
  console.log(errors)
&#125;

if (this.importer.isComplete()) &#123;
  console.log('Import complete')
&#125;</code></pre>

  <h2>Hooking into Events (onComplete, onError)</h2>
  <p>
    If you need side-effects (analytics, notification, routing) when import finishes,
    use constructor callbacks instead of scattering logic across template conditions.
  </p>

  <pre><code>importer = new CSVImporterService(&#123;
  schema,

  onComplete: (result) =&gt; &#123;
    console.log(`Imported $&#123;result.stats.validRows&#125; valid rows`)
  &#125;,

  onError: (error) =&gt; &#123;
    console.error(`Import failed: $&#123;error&#125;`)
  &#125;,

  onStepChange: (step) =&gt; &#123;
    console.log('Step changed', step)
  &#125;,
&#125;)</code></pre>

  <div class="mt-16 flex justify-between">
    <a
      href="/docs/angular/basic"
      class="inline-flex items-center gap-2 px-6 py-3 border border-neutral-300 text-black hover:border-black rounded-md text-sm font-medium no-underline! transition-colors"
      style="text-decoration:none;"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Previous
    </a>
    <a
      href="/docs/angular/full"
      class="inline-flex items-center gap-2 px-6 py-3 bg-black text-white hover:bg-neutral-800 rounded-md text-sm font-medium no-underline! transition-colors"
      style="text-decoration:none;"
    >
      Next: Full API
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        ><path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
      </svg>
    </a>
  </div>
</Layout>
